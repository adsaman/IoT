<html>
	<head>
		<style>
		body {
			background: #ffffff url("bglogo.png") no-repeat center;
			background-size: contain;
			padding: 0 0 0 0;
			margin: 0 0 0 0;
			overflow: hidden;
		}
		div {
			text-align: center;
		}
		img {
			width: 100%;
		}
    </style>
		<script>
		var imgUrl = "http://pnteide.meteorologia.sieltec.es/PNTeide.png?"
		// Try to download a new image each 5m
		var imgDelay = 300000;
		// Check if new image available each 5s
		var checkDelay = 5000;
		var newImage = new Image();

		function preload(url) {
			console.log("Preloading image from: " + url);
			newImage.src = url;
		}

		function updateImage() {
			teideImg = document.getElementById("dashboard");

			if (newImage.src && newImage.complete && teideImg.src != newImage.src) {
				console.log("New image available, updating src: " + newImage.src);
				teideImg.src = newImage.src;
				teideImg.removeAttribute("style");

				setTimeout(preload, imgDelay, imgUrl + new Date().getTime());
			} else {
				console.log("No new image");
			}

			setTimeout(updateImage, checkDelay);
		}

		function loadError(image) {
			console.log("Error loading image");
			image.onerror = "";
			image.style = "display: none";
			preload(imgUrl + new Date().getTime())
			return true;
		}

		setTimeout(preload, imgDelay, imgUrl + new Date().getTime());
		setTimeout(updateImage, checkDelay);
		</script>
	</head>
	<body>
		<img id="dashboard" src="http://pnteide.meteorologia.sieltec.es/PNTeide.png" onerror="loadError(this)" />
	</body>
</html>
